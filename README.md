This is the educational task for university. If you somehow stumble upon this mess, please, understand the level of skill there.
